package com.wyj.adapter;

import java.util.List;
import java.util.Map;

import org.json.JSONArray;
import org.json.JSONObject;

import com.wyj.Activity.R;

import com.wyj.dataprocessing.BitmapManager;

import com.wyj.utils.Tools;

import android.annotation.SuppressLint;
import android.content.Context;

import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import android.widget.BaseAdapter;

import android.widget.ImageView;
import android.widget.TextView;

public class FindListAdapter extends BaseAdapter {
	private Context context;
	public JSONArray data = new JSONArray();
	private List<Map<String, Object>> mData;

	public static class ListItem {
		ImageView list_find_headface;
		TextView list_find_content;
		TextView list_find_username;
		TextView list_find_address;
		TextView list_find_jiachi;
		TextView list_find_zan;
	}

	public FindListAdapter(Context context, List<Map<String, Object>> list) {
		this.context = context;
		this.mData = list;
	}

	@Override
	public int getCount() {
		return this.mData.size();
	}

	@Override
	public Object getItem(int position) {
		return position;
	}

	@Override
	public long getItemId(int position) {
		return position;
	}

	@SuppressLint("InflateParams")
	@Override
	public View getView(int position, View convertView, ViewGroup parent) {
		final ListItem listItem;

		final JSONObject item = this.data.optJSONObject(position);

		if (convertView == null) {
			listItem = new ListItem();
			convertView = LayoutInflater.from(this.context).inflate(
					R.layout.list_find_items, null);
			listItem.list_find_headface = (ImageView) convertView
					.findViewById(R.id.list_find_headface);
			listItem.list_find_content = (TextView) convertView
					.findViewById(R.id.list_find_content);
			listItem.list_find_username = (TextView) convertView
					.findViewById(R.id.list_find_username);
			listItem.list_find_address = (TextView) convertView
					.findViewById(R.id.list_find_address);
			listItem.list_find_jiachi = (TextView) convertView
					.findViewById(R.id.list_find_jiachi);

			listItem.list_find_zan = (TextView) convertView
					.findViewById(R.id.list_find_zan);

			listItem.list_find_zan.setTag(position);
			convertView.setTag(listItem);
		} else {
			listItem = (ListItem) convertView.getTag();
		}

		// viewHolder.img.setBackgroundResource(R.drawable.foot_07);
		BitmapManager.getInstance().loadBitmap(
				(String) this.mData.get(position).get("headface"),
				listItem.list_find_headface,
				Tools.readBitmap(this.context, R.drawable.foot_07));

		listItem.list_find_content.setText((CharSequence) this.mData.get(
				position).get("wishtext"));
		listItem.list_find_username.setText((CharSequence) this.mData.get(
				position).get("wishname"));

		String findaddress = "刚刚在"
				+ (String) this.mData.get(position).get("templename")
				+ (String) this.mData.get(position).get("alsowish")
				+ (String) this.mData.get(position).get("wishtype");

		int co_blessings = (Integer) this.mData.get(position).get(
				"co_blessings");
		String jiachipeople = "";
		if (co_blessings > 0) {
			jiachipeople = (String) this.mData.get(position).get(
					"name_blessings")
					+ "等" + co_blessings + "人加持";
		}
		listItem.list_find_address.setText(findaddress);
		listItem.list_find_jiachi.setText(jiachipeople);

		return convertView;
	}

}